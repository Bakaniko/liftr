<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dockerize R Markdown Documents â€¢ liftr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-65001771-1', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">liftr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/road2stat/liftr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Dockerize R Markdown Documents</h1>
                        <h4 class="author">Nan Xiao &lt;<a href="https://nanx.me" class="uri">https://nanx.me</a>&gt;</h4>
            
            <h4 class="date">2017-04-09</h4>
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In essence, liftr aims to solve persistent reproducible reporting. To solve this problem, liftr extended the <a href="http://rmarkdown.rstudio.com">R Markdown</a> metadata format, and uses Docker to containerize and render R Markdown documents.</p>
</div>
<div id="metadata-for-containerization" class="section level1">
<h1 class="hasAnchor">
<a href="#metadata-for-containerization" class="anchor"></a>Metadata for Containerization</h1>
<p>To dockerize your R Markdown document, the first step is adding <code>liftr</code> options in the YAML front-matter of a document. For example:</p>
<div class="sourceCode"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="ot">---</span>
<span class="fu">title:</span> <span class="st">"The Missing Example of liftr"</span>
<span class="fu">author:</span> <span class="st">"Author Name"</span>
<span class="fu">date:</span> <span class="st">"2017-04-09"</span>
<span class="fu">output:</span>
  <span class="fu">html_document:</span>
    <span class="fu">highlight:</span> haddock
    <span class="fu">theme:</span> readable
<span class="fu">liftr:</span>
  <span class="fu">maintainer:</span> <span class="st">"Author Name"</span>
  <span class="fu">maintainer_email:</span> <span class="st">"name@example.com"</span>
  <span class="fu">from:</span> <span class="st">"rocker/r-base:latest"</span>
  <span class="fu">latex:</span> false
  <span class="fu">pandoc:</span> true
  <span class="fu">syslib:</span>
    <span class="kw">-</span> gfortran
    <span class="kw">-</span> samtools
  <span class="fu">cranpkg:</span>
    <span class="kw">-</span> randomForest
  <span class="fu">biocpkg:</span>
    <span class="kw">-</span> Gviz
    <span class="kw">-</span> ggbio
  <span class="fu">ghpkg:</span>
    <span class="kw">-</span> <span class="st">"road2stat/liftr"</span>
<span class="ot">---</span></code></pre></div>
<p>All available metadata fields are expained below.</p>
<div id="required-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#required-metadata" class="anchor"></a>Required metadata</h2>
<ul>
<li>
<code>maintainer</code> - Maintainer name for the <code>Dockerfile</code>.</li>
<li>
<code>maintainer_email</code> - Maintainer email address for the <code>Dockerfile</code>.</li>
</ul>
</div>
<div id="optional-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#optional-metadata" class="anchor"></a>Optional metadata</h2>
<ul>
<li>
<code>from</code> - <a href="https://docs.docker.com/reference/builder/#from">Base image</a> for building the docker image. Default is <code>"rocker/r-base:latest"</code>.</li>
<li>
<code>latex</code> - Is TeX environment needed when rendering the document? Default is <code>false</code>.</li>
<li>
<code>pandoc</code> - Should we install pandoc in the container? Default is <code>true</code>. If pandoc was already installed in the base image, this should be set to <code>false</code> to avoid potential errors. For example, for <a href="https://registry.hub.docker.com/u/rocker/rstudio/"><code>rocker/rstudio</code></a> and <a href="https://www.bioconductor.org/help/docker/"><code>bioconductor/...</code></a> images, this option will be automatically set to <code>false</code> since they already have pandoc installed.</li>
<li>
<code>syslib</code> - Debian/Ubuntu system software packages depended in the document. Please also include software packages depended by the R packages included below, such as <code>gfortran</code> here required for compiling <code>randomForest</code>.</li>
<li>
<code>cranpkg</code> - CRAN packages depended in the document. If only <code>pkgname</code> is provided, <code>liftr</code> will install the <em>latest</em> version of the package on CRAN. To improve reproducibility, we recommend to use the package name with a specified version number: <code>pkgname/pkgversion</code> (e.g. <code>ggplot2/1.0.0</code>), even if the version is the current latest version. Note: <code>pkgversion</code> must be provided to install the archived versions of packages.</li>
<li>
<code>biocpkg</code> - Bioconductor packages depended in the document.</li>
<li>
<code>ghpkg</code> - GitHub R packages depended in the document. We accept the same format as the <code>repo</code> argument in <code>devtools::install_github</code>. Normally, <code>"username/repo"</code> would be sufficient.</li>
</ul>
</div>
</div>
<div id="use-lift-and-drender" class="section level1">
<h1 class="hasAnchor">
<a href="#use-lift-and-drender" class="anchor"></a>Use <code><a href="../reference/lift.html">lift()</a></code> and <code><a href="../reference/drender.html">drender()</a></code>
</h1>
<p>After adding proper <code>liftr</code> metadata to the document YAML data block, we can use <code><a href="../reference/lift.html">lift()</a></code> to parse the document and generate a <code>Dockerfile</code> (it will also generate a <code>Rabixfile</code> if necessary).</p>
<p>We will use <a href="https://github.com/road2stat/liftr/blob/master/inst/docker.Rmd">docker.Rmd</a> included in the package as an example. First, we create a new directory and copy the example document to the directory:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dir_docker =<span class="st"> "~/liftr_docker/"</span>
<span class="kw">dir.create</span>(dir_docker)
<span class="kw">file.copy</span>(<span class="kw">system.file</span>(<span class="st">"docker.Rmd"</span>, <span class="dt">package =</span> <span class="st">"liftr"</span>), dir_docker)</code></pre></div>
<p>Then, we use <code><a href="../reference/lift.html">lift()</a></code> to parse the document and generate <code>Dockerfile</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"liftr"</span>)
docker_input =<span class="st"> </span><span class="kw">paste0</span>(dir_docker, <span class="st">"docker.Rmd"</span>)
<span class="kw"><a href="../reference/lift.html">lift</a></span>(docker_input)</code></pre></div>
<p>After successfully running <code><a href="../reference/lift.html">lift()</a></code> on <code>docker.Rmd</code>, the <code>Dockerfile</code> will be in the <code>~/liftr_docker/</code> directory.</p>
<p>Now we can use <code><a href="../reference/drender.html">drender()</a></code> on <code>docker.Rmd</code> to render the document to a html file, under a Docker container:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/drender.html">drender</a></span>(docker_input)</code></pre></div>
<p>The <code><a href="../reference/drender.html">drender()</a></code> function will parse the <code>Dockerfile</code>, build a new Docker image, and run a container to render the input document. If successfully rendered, the output <code>docker.html</code> will be in the <code>~/liftr_docker/</code> directory. You can also passed additional arguments in <code>rmarkdown::render</code> to this function.</p>
<p>In order to share the dockerized R Markdown document, simply share the <code>.Rmd</code> file. Other users can use the <code><a href="../reference/lift.html">lift()</a></code> and <code><a href="../reference/drender.html">drender()</a></code> functions to render the document as above.</p>
</div>
<div id="system-requirements" class="section level1">
<h1 class="hasAnchor">
<a href="#system-requirements" class="anchor"></a>System Requirements</h1>
<p>Docker is an essential system requirement when using liftr to render the R Markdown documents. Besides Linux, Docker Engine has a much improved near-native support for Mac and Windows since 2016, so there should not be a problem if you use the officially recommended installation. If not, simply make sure that you can run <code>docker</code> under shell. For example, to install Docker under Ubuntu:</p>
<pre><code>sudo apt-get install docker.io</code></pre>
<p>We should configure Docker to <a href="https://docs.docker.com/installation/ubuntulinux/#create-a-docker-group">run without sudo</a>. To avoid <code>sudo</code> when using the <code>docker</code> command, simply create a group named <code>docker</code> and add yourself to it:</p>
<pre><code>sudo usermod -aG docker your-username</code></pre>
<p>Here is a <a href="(https://docs.docker.com/installation/)">detailed guide</a> for installing Docker on the other platforms.</p>
<hr>
<p><a href="https://liftr.me" class="uri">https://liftr.me</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#metadata-for-containerization">Metadata for Containerization</a><ul class="nav nav-pills nav-stacked">
<li><a href="#required-metadata">Required metadata</a></li>
      <li><a href="#optional-metadata">Optional metadata</a></li>
      </ul>
</li>
      <li><a href="#use-lift-and-drender">Use <code><a href="../reference/lift.html">lift()</a></code> and <code><a href="../reference/drender.html">drender()</a></code></a></li>
      <li><a href="#system-requirements">System Requirements</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nan Xiao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
